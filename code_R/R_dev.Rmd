---
title: "Untitled"
output: html_document
---

to knitr?

```{r}
library(knitr)
purl("run_pooled.Rmd", output = "run_pooled.R", documentation = 2)
```



setup

```{r}
# working directory 
setwd("~/BayesWorkflow/code_r")

# packages
pacman::p_load(tidyverse, 
               brms,
               modelr,
               tidybayes)

# load functions from fun_models.R
source("fun_models.R")
source("fun_helper.R")
```

load the model

```{r}

# sampled models
m_pooled_posterior <- readRDS("../models_R/m_multilevel_generic_fit.rds")

```

load test data

```{r}

# read test data
train <- read_csv("../data/train.csv") %>%
  mutate(idx = as_factor(idx))

```

```{r}
library(bayesplot)
mcmc_intervals(m_pooled_posterior,
          pars = c("b_Intercept",
                   "b_t",
                   "sigma")) +
  ggtitle("title")



```

good alternative
https://cran.r-project.org/web/packages/bayesplot/vignettes/plotting-mcmc-draws.html
```{r}

# not clear what the size is or whether we have control
mcmc_areas(
  m_pooled_posterior,
          pars = c("b_Intercept",
                   "b_t",
                   "sigma"),
  prob = 0.8, # 80% intervals
  prob_outer = 0.99, # 99%
  point_est = "mean"
) + 
  ggtitle("R/brms: Ridgeplot 80% HDI")

# 
```

